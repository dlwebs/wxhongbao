<h2 class="sub-header">添加公众号</h2>
<div class="row placeholders">
    <div class="col-md-7">
        <form class="form-horizontal" role="form" method="post" id="wxform" action="__MODULE__/Weixin/save" enctype="multipart/form-data">
            <div class="form-group">
              <label for="weixin_number" class="col-sm-3 control-label">公众号原始ID</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" id="weixin_number" name="weixin_number" value="" required autofocus>
              </div>
            </div>
            <div class="form-group">
              <label for="weixin_name" class="col-sm-3 control-label">公众号名称</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" id="weixin_name" name="weixin_name" value="" required>
              </div>
            </div>
            <div class="form-group">
              <label for="weixin_appid" class="col-sm-3 control-label">AppID</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" id="weixin_appid" name="weixin_appid" value="" required>
              </div>
            </div>
            <div class="form-group">
              <label for="weixin_appsecret" class="col-sm-3 control-label">AppSecret</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" id="weixin_appsecret" name="weixin_appsecret" value="" required>
              </div>
            </div>
            <div class="form-group">
              <label for="weixin_callbackurl" class="col-sm-3 control-label">回调地址</label>
              <div class="col-sm-9">
                  <input type="text" class="form-control" id="weixin_callbackurl" name="weixin_callbackurl" value="{$callbackUrl}" readonly>
              </div>
            </div>
            <div class="form-group">
              <label for="weixin_token" class="col-sm-3 control-label">Token</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" id="weixin_token" name="weixin_token" value="{$token}" readonly>
              </div>
            </div>
            <div class="form-group">
              <label for="weixin_token" class="col-sm-3 control-label">第三方转发地址</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" id="weixin_dispatchurl" name="weixin_dispatchurl" value="" placeholder="以http://开头，可以留空">
              </div>
            </div>
            <div class="form-group">
              <label for="weixin_token" class="col-sm-3 control-label">第三方Token</label>
              <div class="col-sm-9">
                <input type="text" class="form-control" id="weixin_dispatchtoken" name="weixin_dispatchtoken" value="" placeholder="可以留空">
              </div>
            </div>
            <div class="form-group">
              <label for="weixin_imgcode" class="col-sm-3 control-label">二维码</label>
              <div class="col-sm-9">
                <input type="file" id="weixin_imgcode" name="weixin_imgcode">
              </div>
            </div>
            <div class="form-group">
              <div class="col-sm-offset-2 col-sm-10">
                <button type="button" class="btn btn-default" id="addbtn">添加</button>
              </div>
            </div>
          </form>
  </div>
</div>
<script type="text/javascript">
$(function () {
    $("#addbtn").click(function () {
        var weixin_number = $("#weixin_number").val();
        var weixin_name = $("#weixin_name").val();
        var weixin_appid = $("#weixin_appid").val();
        var weixin_imgcode = $("#weixin_imgcode").val();
        var weixin_appsecret = $("#weixin_appsecret").val();
        if (!weixin_number) {
            alert("请填写公众号原始ID");
            return false;
        }
        if (!weixin_name) {
            alert("请填写公众号名称");
            return false;
        }
        if (!weixin_appid) {
            alert("请填写AppID");
            return false;
        }
        if (!weixin_appsecret) {
            alert("请填写AppSecret");
            return false;
        }
        if (!weixin_imgcode) {
            alert("请上传公众号二维码");
            return false;
        }
        var weixin_dispatchurl = $("#weixin_dispatchurl").val();
        var weixin_dispatchtoken = $("#weixin_dispatchtoken").val();
        if (weixin_dispatchurl) {
            if (!weixin_dispatchtoken) {
                alert("请填写第三方Token");
                return false;
            }
        } else {
            if (weixin_dispatchtoken) {
                alert("请填写第三方转发地址");
                return false;
            }
        }
        $("#wxform").submit();
    });
});
</script>